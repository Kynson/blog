---
interface Props {
  theme: string,
  lang: string,
  code: string,
}

import { getHighlighterCore, loadWasm } from 'shikiji/core';

import oneDarkProTheme from 'shikiji/themes/one-dark-pro.mjs';
import githubLightTheme from 'shikiji/themes/github-light.mjs';

import js from 'shikiji/langs/javascript.mjs';

import highlighterWasm from 'shikiji/onig.wasm?module';
await loadWasm((importObject) => WebAssembly.instantiate(highlighterWasm, importObject));

const { theme, lang, code } = Astro.props;

const highlighter = await getHighlighterCore({
  themes: [oneDarkProTheme, githubLightTheme],
  langs: [js],
});

const html = highlighter.codeToHtml(code, { theme, lang });
---

<Fragment set:html={html}>

</Fragment>